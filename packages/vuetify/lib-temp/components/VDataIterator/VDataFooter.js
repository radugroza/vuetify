import './VDataFooter.sass';
// Components
import VSelect from '../VSelect/VSelect';
import VIcon from '../VIcon';
import VBtn from '../VBtn';
// Types
import Vue from 'vue';
export default Vue.extend({
    name: 'v-data-footer',
    props: {
        options: {
            type: Object,
            required: true,
        },
        pagination: {
            type: Object,
            required: true,
        },
        itemsPerPageOptions: {
            type: Array,
            default: () => ([5, 10, 15, -1]),
        },
        prevIcon: {
            type: String,
            default: '$prev',
        },
        nextIcon: {
            type: String,
            default: '$next',
        },
        firstIcon: {
            type: String,
            default: '$first',
        },
        lastIcon: {
            type: String,
            default: '$last',
        },
        itemsPerPageText: {
            type: String,
            default: '$vuetify.dataFooter.itemsPerPageText',
        },
        itemsPerPageAllText: {
            type: String,
            default: '$vuetify.dataFooter.itemsPerPageAll',
        },
        showFirstLastPage: Boolean,
        showCurrentPage: Boolean,
        disablePagination: Boolean,
        disableItemsPerPage: Boolean,
        pageText: {
            type: String,
            default: '$vuetify.dataFooter.pageText',
        },
    },
    computed: {
        disableNextPageIcon() {
            return this.options.itemsPerPage <= 0 ||
                this.options.page * this.options.itemsPerPage >= this.pagination.itemsLength ||
                this.pagination.pageStop < 0;
        },
        computedDataItemsPerPageOptions() {
            return this.itemsPerPageOptions.map(option => {
                if (typeof option === 'object')
                    return option;
                else
                    return this.genDataItemsPerPageOption(option);
            });
        },
    },
    methods: {
        updateOptions(obj) {
            this.$emit('update:options', Object.assign({}, this.options, obj));
        },
        onFirstPage() {
            this.updateOptions({ page: 1 });
        },
        onPreviousPage() {
            this.updateOptions({ page: this.options.page - 1 });
        },
        onNextPage() {
            this.updateOptions({ page: this.options.page + 1 });
        },
        onLastPage() {
            this.updateOptions({ page: this.pagination.pageCount });
        },
        onChangeItemsPerPage(itemsPerPage) {
            this.updateOptions({ itemsPerPage, page: 1 });
        },
        genDataItemsPerPageOption(option) {
            return {
                text: option === -1 ? this.$vuetify.lang.t(this.itemsPerPageAllText) : String(option),
                value: option,
            };
        },
        genItemsPerPageSelect() {
            let value = this.options.itemsPerPage;
            const computedIPPO = this.computedDataItemsPerPageOptions;
            if (computedIPPO.length <= 1)
                return null;
            if (!computedIPPO.find(ippo => ippo.value === value))
                value = computedIPPO[0];
            return this.$createElement('div', {
                staticClass: 'v-data-footer__select',
            }, [
                this.$vuetify.lang.t(this.itemsPerPageText),
                this.$createElement(VSelect, {
                    attrs: {
                        'aria-label': this.itemsPerPageText,
                    },
                    props: {
                        disabled: this.disableItemsPerPage,
                        items: computedIPPO,
                        value,
                        hideDetails: true,
                        auto: true,
                        minWidth: '75px',
                    },
                    on: {
                        input: this.onChangeItemsPerPage,
                    },
                }),
            ]);
        },
        genPaginationInfo() {
            let children = ['â€“'];
            if (this.pagination.itemsLength && this.pagination.itemsPerPage) {
                const itemsLength = this.pagination.itemsLength;
                const pageStart = this.pagination.pageStart + 1;
                const pageStop = itemsLength < this.pagination.pageStop || this.pagination.pageStop < 0
                    ? itemsLength
                    : this.pagination.pageStop;
                children = this.$scopedSlots['page-text']
                    ? [this.$scopedSlots['page-text']({ pageStart, pageStop, itemsLength })]
                    : [this.$vuetify.lang.t(this.pageText, pageStart, pageStop, itemsLength)];
            }
            return this.$createElement('div', {
                class: 'v-data-footer__pagination',
            }, children);
        },
        genIcon(click, disabled, label, icon) {
            return this.$createElement(VBtn, {
                props: {
                    disabled: disabled || this.disablePagination,
                    icon: true,
                    text: true,
                },
                on: {
                    click,
                },
                attrs: {
                    'aria-label': label,
                },
            }, [this.$createElement(VIcon, icon)]);
        },
        genIcons() {
            const before = [];
            const after = [];
            before.push(this.genIcon(this.onPreviousPage, this.options.page === 1, this.$vuetify.lang.t('$vuetify.dataFooter.prevPage'), this.$vuetify.rtl ? this.nextIcon : this.prevIcon));
            after.push(this.genIcon(this.onNextPage, this.disableNextPageIcon, this.$vuetify.lang.t('$vuetify.dataFooter.nextPage'), this.$vuetify.rtl ? this.prevIcon : this.nextIcon));
            if (this.showFirstLastPage) {
                before.unshift(this.genIcon(this.onFirstPage, this.options.page === 1, this.$vuetify.lang.t('$vuetify.dataFooter.firstPage'), this.$vuetify.rtl ? this.lastIcon : this.firstIcon));
                after.push(this.genIcon(this.onLastPage, this.options.page >= this.pagination.pageCount || this.options.itemsPerPage === -1, this.$vuetify.lang.t('$vuetify.dataFooter.lastPage'), this.$vuetify.rtl ? this.firstIcon : this.lastIcon));
            }
            return [
                this.$createElement('div', {
                    staticClass: 'v-data-footer__icons-before',
                }, before),
                this.showCurrentPage && this.$createElement('span', [this.options.page.toString()]),
                this.$createElement('div', {
                    staticClass: 'v-data-footer__icons-after',
                }, after),
            ];
        },
    },
    render() {
        return this.$createElement('div', {
            staticClass: 'v-data-footer',
        }, [
            this.genItemsPerPageSelect(),
            this.genPaginationInfo(),
            this.genIcons(),
        ]);
    },
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiVkRhdGFGb290ZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvY29tcG9uZW50cy9WRGF0YUl0ZXJhdG9yL1ZEYXRhRm9vdGVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sb0JBQW9CLENBQUE7QUFFM0IsYUFBYTtBQUNiLE9BQU8sT0FBTyxNQUFNLG9CQUFvQixDQUFBO0FBQ3hDLE9BQU8sS0FBSyxNQUFNLFVBQVUsQ0FBQTtBQUM1QixPQUFPLElBQUksTUFBTSxTQUFTLENBQUE7QUFFMUIsUUFBUTtBQUNSLE9BQU8sR0FBb0QsTUFBTSxLQUFLLENBQUE7QUFJdEUsZUFBZSxHQUFHLENBQUMsTUFBTSxDQUFDO0lBQ3hCLElBQUksRUFBRSxlQUFlO0lBRXJCLEtBQUssRUFBRTtRQUNMLE9BQU8sRUFBRTtZQUNQLElBQUksRUFBRSxNQUErQjtZQUNyQyxRQUFRLEVBQUUsSUFBSTtTQUNmO1FBQ0QsVUFBVSxFQUFFO1lBQ1YsSUFBSSxFQUFFLE1BQWtDO1lBQ3hDLFFBQVEsRUFBRSxJQUFJO1NBQ2Y7UUFDRCxtQkFBbUIsRUFBRTtZQUNuQixJQUFJLEVBQUUsS0FBSztZQUNYLE9BQU8sRUFBRSxHQUFHLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQztTQUNVO1FBQzVDLFFBQVEsRUFBRTtZQUNSLElBQUksRUFBRSxNQUFNO1lBQ1osT0FBTyxFQUFFLE9BQU87U0FDakI7UUFDRCxRQUFRLEVBQUU7WUFDUixJQUFJLEVBQUUsTUFBTTtZQUNaLE9BQU8sRUFBRSxPQUFPO1NBQ2pCO1FBQ0QsU0FBUyxFQUFFO1lBQ1QsSUFBSSxFQUFFLE1BQU07WUFDWixPQUFPLEVBQUUsUUFBUTtTQUNsQjtRQUNELFFBQVEsRUFBRTtZQUNSLElBQUksRUFBRSxNQUFNO1lBQ1osT0FBTyxFQUFFLE9BQU87U0FDakI7UUFDRCxnQkFBZ0IsRUFBRTtZ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VUFBVSxDQUFDLFNBQVMsSUFBSSxJQUFJLENBQUMsT0FBTyxDQUFDLFlBQVksS0FBSyxDQUFDLENBQUMsRUFDbEYsSUFBSSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLDhCQUE4QixDQUFDLEVBQ3BELElBQUksQ0FBQyxRQUFRLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUNuRCxDQUFDLENBQUE7YUFDSDtZQUVELE9BQU87Z0JBQ0wsSUFBSSxDQUFDLGNBQWMsQ0FBQyxLQUFLLEVBQUU7b0JBQ3pCLFdBQVcsRUFBRSw2QkFBNkI7aUJBQzNDLEVBQUUsTUFBTSxDQUFDO2dCQUNWLElBQUksQ0FBQyxlQUFlLElBQUksSUFBSSxDQUFDLGNBQWMsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxRQUFRLEVBQUUsQ0FBQyxDQUFDO2dCQUNuRixJQUFJLENBQUMsY0FBYyxDQUFDLEtBQUssRUFBRTtvQkFDekIsV0FBVyxFQUFFLDRCQUE0QjtpQkFDMUMsRUFBRSxLQUFLLENBQUM7YUFDVixDQUFBO1FBQ0gsQ0FBQztLQUNGO0lBRUQsTUFBTTtRQUNKLE9BQU8sSUFBSSxDQUFDLGNBQWMsQ0FBQyxLQUFLLEVBQUU7WUFDaEMsV0FBVyxFQUFFLGVBQWU7U0FDN0IsRUFBRTtZQUNELElBQUksQ0FBQyxxQkFBcUIsRUFBRTtZQUM1QixJQUFJLENBQUMsaUJBQWlCLEVBQUU7WUFDeEIsSUFBSSxDQUFDLFFBQVEsRUFBRTtTQUNoQixDQUFDLENBQUE7SUFDSixDQUFDO0NBQ0YsQ0FBQyxDQUFBIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICcuL1ZEYXRhRm9vdGVyLnNhc3MnXG5cbi8vIENvbXBvbmVudHNcbmltcG9ydCBWU2VsZWN0IGZyb20gJy4uL1ZTZWxlY3QvVlNlbGVjdCdcbmltcG9ydCBWSWNvbiBmcm9tICcuLi9WSWNvbidcbmltcG9ydCBWQnRuIGZyb20gJy4uL1ZCdG4nXG5cbi8vIFR5cGVzXG5pbXBvcnQgVnVlLCB7IFZOb2RlLCBWTm9kZUNoaWxkcmVuQXJyYXlDb250ZW50cywgUHJvcFR5cGUgfSBmcm9tICd2dWUnXG5pbXBvcnQgeyBEYXRhUGFnaW5hdGlvbiwgRGF0YU9wdGlvbnMsIERhdGFJdGVtc1BlclBhZ2VPcHRpb24gfSBmcm9tICd2dWV0aWZ5L3R5cGVzJ1xuaW1wb3J0IHsgUHJvcFZhbGlkYXRvciB9IGZyb20gJ3Z1ZS90eXBlcy9vcHRpb25zJ1xuXG5leHBvcnQgZGVmYXVsdCBWdWUuZXh0ZW5kKHtcbiAgbmFtZTogJ3YtZGF0YS1mb290ZXInLFxuXG4gIHByb3BzOiB7XG4gICAgb3B0aW9uczoge1xuICAgICAgdHlwZTogT2JqZWN0IGFzIFByb3BUeXBlPERhdGFPcHRpb25zPixcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgIH0sXG4gICAgcGFnaW5hdGlvbjoge1xuICAgICAgdHlwZTogT2JqZWN0IGFzIFByb3BUeXBlPERhdGFQYWdpbmF0aW9uPixcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgIH0sXG4gICAgaXRlbXNQZXJQYWdlT3B0aW9uczoge1xuICAgICAgdHlwZTogQXJyYXksXG4gICAgICBkZWZhdWx0OiAoKSA9PiAoWzUsIDEwLCAxNSwgLTFdKSxcbiAgICB9IGFzIFByb3BWYWxpZGF0b3I8RGF0YUl0ZW1zUGVyUGFnZU9wdGlvbltdPixcbiAgICBwcmV2SWNvbjoge1xuICAgICAgdHlwZTogU3RyaW5nLFxuICAgICAgZGVmYXVsdDogJyRwcmV2JyxcbiAgICB9LFxuICAgIG5leHRJY29uOiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICBkZWZhdWx0OiAnJG5leHQnLFxuICAgIH0sXG4gICAgZmlyc3RJY29uOiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICBkZWZhdWx0OiAnJGZpcnN0JyxcbiAgICB9LFxuICAgIGxhc3RJY29uOiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICBkZWZhdWx0OiAnJGxhc3QnLFxuICAgIH0sXG4gICAgaXRlbXNQZXJQYWdlVGV4dDoge1xuICAgICAgdHlwZTogU3RyaW5nLFxuICAgICAgZGVmYXVsdDogJyR2dWV0aWZ5LmRhdGFGb290ZXIuaXRlbXNQZXJQYWdlVGV4dCcsXG4gICAgfSxcbiAgICBpdGVtc1BlclBhZ2VBbGxUZXh0OiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICBkZWZhdWx0OiAnJHZ1ZXRpZnkuZGF0YUZvb3Rlci5pdGVtc1BlclBhZ2VBbGwnLFxuICAgIH0sXG4gICAgc2hvd0ZpcnN0TGFzdFBhZ2U6IEJvb2xlYW4sXG4gICAgc2hvd0N1cnJlbnRQYWdlOiBCb29sZWFuLFxuICAgIGRpc2FibGVQYWdpbmF0aW9uOiBCb29sZWFuLFxuICAgIGRpc2FibGVJdGVtc1BlclBhZ2U6IEJvb2xlYW4sXG4gICAgcGFnZVRleHQ6IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIGRlZmF1bHQ6ICckdnVldGlmeS5kYXRhRm9vdGVyLnBhZ2VUZXh0JyxcbiAgICB9LFxuICB9LFxuXG4gIGNvbXB1dGVkOiB7XG4gICAgZGlzYWJsZU5leHRQYWdlSWNvbiAoKTogYm9vbGVhbiB7XG4gICAgICByZXR1cm4gdGhpcy5vcHRpb25zLml0ZW1zUGVyUGFnZSA8PSAwIHx8XG4gICAgICAgIHRoaXMub3B0aW9ucy5wYWdlICogdGhpcy5vcHRpb25zLml0ZW1zUGVyUGFnZSA+PSB0aGlzLnBhZ2luYXRpb24uaXRlbXNMZW5ndGggfHxcbiAgICAgICAgdGhpcy5wYWdpbmF0aW9uLnBhZ2VTdG9wIDwgMFxuICAgIH0sXG4gICAgY29tcHV0ZWREYXRhSXRlbXNQZXJQYWdlT3B0aW9ucyAoKTogYW55W10ge1xuICAgICAgcmV0dXJuIHRoaXMuaXRlbXNQZXJQYWdlT3B0aW9ucy5tYXAob3B0aW9uID0+IHtcbiAgICAgICAgaWYgKHR5cGVvZiBvcHRpb24gPT09ICdvYmplY3QnKSByZXR1cm4gb3B0aW9uXG4gICAgICAgIGVsc2UgcmV0dXJuIHRoaXMuZ2VuRGF0YUl0ZW1zUGVyUGFnZU9wdGlvbihvcHRpb24pXG4gICAgICB9KVxuICAgIH0sXG4gIH0sXG5cbiAgbWV0aG9kczoge1xuICAgIHVwZGF0ZU9wdGlvbnMgKG9iajogb2JqZWN0KSB7XG4gICAgICB0aGlzLiRlbWl0KCd1cGRhdGU6b3B0aW9ucycsIE9iamVjdC5hc3NpZ24oe30sIHRoaXMub3B0aW9ucywgb2JqKSlcbiAgICB9LFxuICAgIG9uRmlyc3RQYWdlICgpIHtcbiAgICAgIHRoaXMudXBkYXRlT3B0aW9ucyh7IHBhZ2U6IDEgfSlcbiAgICB9LFxuICAgIG9uUHJldmlvdXNQYWdlICgpIHtcbiAgICAgIHRoaXMudXBkYXRlT3B0aW9ucyh7IHBhZ2U6IHRoaXMub3B0aW9ucy5wYWdlIC0gMSB9KVxuICAgIH0sXG4gICAgb25OZXh0UGFnZSAoKSB7XG4gICAgICB0aGlzLnVwZGF0ZU9wdGlvbnMoeyBwYWdlOiB0aGlzLm9wdGlvbnMucGFnZSArIDEgfSlcbiAgICB9LFxuICAgIG9uTGFzdFBhZ2UgKCkge1xuICAgICAgdGhpcy51cGRhdGVPcHRpb25zKHsgcGFnZTogdGhpcy5wYWdpbmF0aW9uLnBhZ2VDb3VudCB9KVxuICAgIH0sXG4gICAgb25DaGFuZ2VJdGVtc1BlclBhZ2UgKGl0ZW1zUGVyUGFnZTogbnVtYmVyKSB7XG4gICAgICB0aGlzLnVwZGF0ZU9wdGlvbnMoeyBpdGVtc1BlclBhZ2UsIHBhZ2U6IDEgfSlcbiAgICB9LFxuICAgIGdlbkRhdGFJdGVtc1BlclBhZ2VPcHRpb24gKG9wdGlvbjogbnVtYmVyKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB0ZXh0OiBvcHRpb24gPT09IC0xID8gdGhpcy4kdnVldGlmeS5sYW5nLnQodGhpcy5pdGVtc1BlclBhZ2VBbGxUZXh0KSA6IFN0cmluZyhvcHRpb24pLFxuICAgICAgICB2YWx1ZTogb3B0aW9uLFxuICAgICAgfVxuICAgIH0sXG4gICAgZ2VuSXRlbXNQZXJQYWdlU2VsZWN0ICgpIHtcbiAgICAgIGxldCB2YWx1ZSA9IHRoaXMub3B0aW9ucy5pdGVtc1BlclBhZ2VcbiAgICAgIGNvbnN0IGNvbXB1dGVkSVBQTyA9IHRoaXMuY29tcHV0ZWREYXRhSXRlbXNQZXJQYWdlT3B0aW9uc1xuXG4gICAgICBpZiAoY29tcHV0ZWRJUFBPLmxlbmd0aCA8PSAxKSByZXR1cm4gbnVsbFxuXG4gICAgICBpZiAoIWNvbXB1dGVkSVBQTy5maW5kKGlwcG8gPT4gaXBwby52YWx1ZSA9PT0gdmFsdWUpKSB2YWx1ZSA9IGNvbXB1dGVkSVBQT1swXVxuXG4gICAgICByZXR1cm4gdGhpcy4kY3JlYXRlRWxlbWVudCgnZGl2Jywge1xuICAgICAgICBzdGF0aWNDbGFzczogJ3YtZGF0YS1mb290ZXJfX3NlbGVjdCcsXG4gICAgICB9LCBbXG4gICAgICAgIHRoaXMuJHZ1ZXRpZnkubGFuZy50KHRoaXMuaXRlbXNQZXJQYWdlVGV4dCksXG4gICAgICAgIHRoaXMuJGNyZWF0ZUVsZW1lbnQoVlNlbGVjdCwge1xuICAgICAgICAgIGF0dHJzOiB7XG4gICAgICAgICAgICAnYXJpYS1sYWJlbCc6IHRoaXMuaXRlbXNQZXJQYWdlVGV4dCxcbiAgICAgICAgICB9LFxuICAgICAgICAgIHByb3BzOiB7XG4gICAgICAgICAgICBkaXNhYmxlZDogdGhpcy5kaXNhYmxlSXRlbXNQZXJQYWdlLFxuICAgICAgICAgICAgaXRlbXM6IGNvbXB1dGVkSVBQTyxcbiAgICAgICAgICAgIHZhbHVlLFxuICAgICAgICAgICAgaGlkZURldGFpbHM6IHRydWUsXG4gICAgICAgICAgICBhdXRvOiB0cnVlLFxuICAgICAgICAgICAgbWluV2lkdGg6ICc3NXB4JyxcbiAgICAgICAgICB9LFxuICAgICAgICAgIG9uOiB7XG4gICAgICAgICAgICBpbnB1dDogdGhpcy5vbkNoYW5nZUl0ZW1zUGVyUGFnZSxcbiAgICAgICAgICB9LFxuICAgICAgICB9KSxcbiAgICAgIF0pXG4gICAgfSxcbiAgICBnZW5QYWdpbmF0aW9uSW5mbyAoKSB7XG4gICAgICBsZXQgY2hpbGRyZW46IFZOb2RlQ2hpbGRyZW5BcnJheUNvbnRlbnRzID0gWyfigJMnXVxuXG4gICAgICBpZiAodGhpcy5wYWdpbmF0aW9uLml0ZW1zTGVuZ3RoICYmIHRoaXMucGFnaW5hdGlvbi5pdGVtc1BlclBhZ2UpIHtcbiAgICAgICAgY29uc3QgaXRlbXNMZW5ndGggPSB0aGlzLnBhZ2luYXRpb24uaXRlbXNMZW5ndGhcbiAgICAgICAgY29uc3QgcGFnZVN0YXJ0ID0gdGhpcy5wYWdpbmF0aW9uLnBhZ2VTdGFydCArIDFcbiAgICAgICAgY29uc3QgcGFnZVN0b3AgPSBpdGVtc0xlbmd0aCA8IHRoaXMucGFnaW5hdGlvbi5wYWdlU3RvcCB8fCB0aGlzLnBhZ2luYXRpb24ucGFnZVN0b3AgPCAwXG4gICAgICAgICAgPyBpdGVtc0xlbmd0aFxuICAgICAgICAgIDogdGhpcy5wYWdpbmF0aW9uLnBhZ2VTdG9wXG5cbiAgICAgICAgY2hpbGRyZW4gPSB0aGlzLiRzY29wZWRTbG90c1sncGFnZS10ZXh0J11cbiAgICAgICAgICA/IFt0aGlzLiRzY29wZWRTbG90c1sncGFnZS10ZXh0J10hKHsgcGFnZVN0YXJ0LCBwYWdlU3RvcCwgaXRlbXNMZW5ndGggfSldXG4gICAgICAgICAgOiBbdGhpcy4kdnVldGlmeS5sYW5nLnQodGhpcy5wYWdlVGV4dCwgcGFnZVN0YXJ0LCBwYWdlU3RvcCwgaXRlbXNMZW5ndGgpXVxuICAgICAgfVxuXG4gICAgICByZXR1cm4gdGhpcy4kY3JlYXRlRWxlbWVudCgnZGl2Jywge1xuICAgICAgICBjbGFzczogJ3YtZGF0YS1mb290ZXJfX3BhZ2luYXRpb24nLFxuICAgICAgfSwgY2hpbGRyZW4pXG4gICAgfSxcbiAgICBnZW5JY29uIChjbGljazogRnVuY3Rpb24sIGRpc2FibGVkOiBib29sZWFuLCBsYWJlbDogc3RyaW5nLCBpY29uOiBzdHJpbmcpOiBWTm9kZSB7XG4gICAgICByZXR1cm4gdGhpcy4kY3JlYXRlRWxlbWVudChWQnRuLCB7XG4gICAgICAgIHByb3BzOiB7XG4gICAgICAgICAgZGlzYWJsZWQ6IGRpc2FibGVkIHx8IHRoaXMuZGlzYWJsZVBhZ2luYXRpb24sXG4gICAgICAgICAgaWNvbjogdHJ1ZSxcbiAgICAgICAgICB0ZXh0OiB0cnVlLFxuICAgICAgICAgIC8vIGRhcms6IHRoaXMuZGFyaywgLy8gVE9ETzogYWRkIG1peGluXG4gICAgICAgICAgLy8gbGlnaHQ6IHRoaXMubGlnaHQgLy8gVE9ETzogYWRkIG1peGluXG4gICAgICAgIH0sXG4gICAgICAgIG9uOiB7XG4gICAgICAgICAgY2xpY2ssXG4gICAgICAgIH0sXG4gICAgICAgIGF0dHJzOiB7XG4gICAgICAgICAgJ2FyaWEtbGFiZWwnOiBsYWJlbCwgLy8gVE9ETzogTG9jYWxpemF0aW9uXG4gICAgICAgIH0sXG4gICAgICB9LCBbdGhpcy4kY3JlYXRlRWxlbWVudChWSWNvbiwgaWNvbildKVxuICAgIH0sXG4gICAgZ2VuSWNvbnMgKCkge1xuICAgICAgY29uc3QgYmVmb3JlOiBWTm9kZUNoaWxkcmVuQXJyYXlDb250ZW50cyA9IFtdXG4gICAgICBjb25zdCBhZnRlcjogVk5vZGVDaGlsZHJlbkFycmF5Q29udGVudHMgPSBbXVxuXG4gICAgICBiZWZvcmUucHVzaCh0aGlzLmdlbkljb24oXG4gICAgICAgIHRoaXMub25QcmV2aW91c1BhZ2UsXG4gICAgICAgIHRoaXMub3B0aW9ucy5wYWdlID09PSAxLFxuICAgICAgICB0aGlzLiR2dWV0aWZ5LmxhbmcudCgnJHZ1ZXRpZnkuZGF0YUZvb3Rlci5wcmV2UGFnZScpLFxuICAgICAgICB0aGlzLiR2dWV0aWZ5LnJ0bCA/IHRoaXMubmV4dEljb24gOiB0aGlzLnByZXZJY29uXG4gICAgICApKVxuXG4gICAgICBhZnRlci5wdXNoKHRoaXMuZ2VuSWNvbihcbiAgICAgICAgdGhpcy5vbk5leHRQYWdlLFxuICAgICAgICB0aGlzLmRpc2FibGVOZXh0UGFnZUljb24sXG4gICAgICAgIHRoaXMuJHZ1ZXRpZnkubGFuZy50KCckdnVldGlmeS5kYXRhRm9vdGVyLm5leHRQYWdlJyksXG4gICAgICAgIHRoaXMuJHZ1ZXRpZnkucnRsID8gdGhpcy5wcmV2SWNvbiA6IHRoaXMubmV4dEljb25cbiAgICAgICkpXG5cbiAgICAgIGlmICh0aGlzLnNob3dGaXJzdExhc3RQYWdlKSB7XG4gICAgICAgIGJlZm9yZS51bnNoaWZ0KHRoaXMuZ2VuSWNvbihcbiAgICAgICAgICB0aGlzLm9uRmlyc3RQYWdlLFxuICAgICAgICAgIHRoaXMub3B0aW9ucy5wYWdlID09PSAxLFxuICAgICAgICAgIHRoaXMuJHZ1ZXRpZnkubGFuZy50KCckdnVldGlmeS5kYXRhRm9vdGVyLmZpcnN0UGFnZScpLFxuICAgICAgICAgIHRoaXMuJHZ1ZXRpZnkucnRsID8gdGhpcy5sYXN0SWNvbiA6IHRoaXMuZmlyc3RJY29uXG4gICAgICAgICkpXG5cbiAgICAgICAgYWZ0ZXIucHVzaCh0aGlzLmdlbkljb24oXG4gICAgICAgICAgdGhpcy5vbkxhc3RQYWdlLFxuICAgICAgICAgIHRoaXMub3B0aW9ucy5wYWdlID49IHRoaXMucGFnaW5hdGlvbi5wYWdlQ291bnQgfHwgdGhpcy5vcHRpb25zLml0ZW1zUGVyUGFnZSA9PT0gLTEsXG4gICAgICAgICAgdGhpcy4kdnVldGlmeS5sYW5nLnQoJyR2dWV0aWZ5LmRhdGFGb290ZXIubGFzdFBhZ2UnKSxcbiAgICAgICAgICB0aGlzLiR2dWV0aWZ5LnJ0bCA/IHRoaXMuZmlyc3RJY29uIDogdGhpcy5sYXN0SWNvblxuICAgICAgICApKVxuICAgICAgfVxuXG4gICAgICByZXR1cm4gW1xuICAgICAgICB0aGlzLiRjcmVhdGVFbGVtZW50KCdkaXYnLCB7XG4gICAgICAgICAgc3RhdGljQ2xhc3M6ICd2LWRhdGEtZm9vdGVyX19pY29ucy1iZWZvcmUnLFxuICAgICAgICB9LCBiZWZvcmUpLFxuICAgICAgICB0aGlzLnNob3dDdXJyZW50UGFnZSAmJiB0aGlzLiRjcmVhdGVFbGVtZW50KCdzcGFuJywgW3RoaXMub3B0aW9ucy5wYWdlLnRvU3RyaW5nKCldKSxcbiAgICAgICAgdGhpcy4kY3JlYXRlRWxlbWVudCgnZGl2Jywge1xuICAgICAgICAgIHN0YXRpY0NsYXNzOiAndi1kYXRhLWZvb3Rlcl9faWNvbnMtYWZ0ZXInLFxuICAgICAgICB9LCBhZnRlciksXG4gICAgICBdXG4gICAgfSxcbiAgfSxcblxuICByZW5kZXIgKCk6IFZOb2RlIHtcbiAgICByZXR1cm4gdGhpcy4kY3JlYXRlRWxlbWVudCgnZGl2Jywge1xuICAgICAgc3RhdGljQ2xhc3M6ICd2LWRhdGEtZm9vdGVyJyxcbiAgICB9LCBbXG4gICAgICB0aGlzLmdlbkl0ZW1zUGVyUGFnZVNlbGVjdCgpLFxuICAgICAgdGhpcy5nZW5QYWdpbmF0aW9uSW5mbygpLFxuICAgICAgdGhpcy5nZW5JY29ucygpLFxuICAgIF0pXG4gIH0sXG59KVxuIl19