import Vue from 'vue';
export function createSimpleFunctional(c, el = 'div', name) {
    return Vue.extend({
        name: name || c.replace(/__/g, '-'),
        functional: true,
        render(h, { data, children }) {
            data.staticClass = (`${c} ${data.staticClass || ''}`).trim();
            return h(el, data, children);
        },
    });
}
export function directiveConfig(binding, defaults = {}) {
    return {
        ...defaults,
        ...binding.modifiers,
        value: binding.arg,
        ...(binding.value || {}),
    };
}
export function addOnceEventListener(el, eventName, cb, options = false) {
    var once = (event) => {
        cb(event);
        el.removeEventListener(eventName, once, options);
    };
    el.addEventListener(eventName, once, options);
}
let passiveSupported = false;
try {
    if (typeof window !== 'undefined') {
        const testListenerOpts = Object.defineProperty({}, 'passive', {
            get: () => {
                passiveSupported = true;
            },
        });
        window.addEventListener('testListener', testListenerOpts, testListenerOpts);
        window.removeEventListener('testListener', testListenerOpts, testListenerOpts);
    }
}
catch (e) {
    console.warn(e);
}
export { passiveSupported };
export function addPassiveEventListener(el, event, cb, options) {
    el.addEventListener(event, cb, passiveSupported ? options : false);
}
export function getNestedValue(obj, path, fallback) {
    const last = path.length - 1;
    if (last < 0)
        return obj === undefined ? fallback : obj;
    for (let i = 0; i < last; i++) {
        if (obj == null) {
            return fallback;
        }
        obj = obj[path[i]];
    }
    if (obj == null)
        return fallback;
    return obj[path[last]] === undefined ? fallback : obj[path[last]];
}
export function deepEqual(a, b) {
    if (a === b)
        return true;
    if (a instanceof Date && b instanceof Date) {
        // If the values are Date, they were convert to timestamp with getTime and compare it
        if (a.getTime() !== b.getTime())
            return false;
    }
    if (a !== Object(a) || b !== Object(b)) {
        // If the values aren't objects, they were already checked for equality
        return false;
    }
    const props = Object.keys(a);
    if (props.length !== Object.keys(b).length) {
        // Different number of props, don't bother to check
        return false;
    }
    return props.every(p => deepEqual(a[p], b[p]));
}
export function getObjectValueByPath(obj, path, fallback) {
    // credit: http://stackoverflow.com/questions/6491463/accessing-nested-javascript-objects-with-string-key#comment55278413_6491621
    if (obj == null || !path || typeof path !== 'string')
        return fallback;
    if (obj[path] !== undefined)
        return obj[path];
    path = path.replace(/\[(\w+)\]/g, '.$1'); // convert indexes to properties
    path = path.replace(/^\./, ''); // strip a leading dot
    return getNestedValue(obj, path.split('.'), fallback);
}
export function getPropertyFromItem(item, property, fallback) {
    if (property == null)
        return item === undefined ? fallback : item;
    if (item !== Object(item))
        return fallback === undefined ? item : fallback;
    if (typeof property === 'string')
        return getObjectValueByPath(item, property, fallback);
    if (Array.isArray(property))
        return getNestedValue(item, property, fallback);
    if (typeof property !== 'function')
        return fallback;
    const value = property(item, fallback);
    return typeof value === 'undefined' ? fallback : value;
}
export function createRange(length) {
    return Array.from({ length }, (v, k) => k);
}
export function getZIndex(el) {
    if (!el || el.nodeType !== Node.ELEMENT_NODE)
        return 0;
    const index = +window.getComputedStyle(el).getPropertyValue('z-index');
    if (!index)
        return getZIndex(el.parentNode);
    return index;
}
const tagsToReplace = {
    '&': '&amp;',
    '<': '&lt;',
    '>': '&gt;',
};
export function escapeHTML(str) {
    return str.replace(/[&<>]/g, tag => tagsToReplace[tag] || tag);
}
export function filterObjectOnKeys(obj, keys) {
    const filtered = {};
    for (let i = 0; i < keys.length; i++) {
        const key = keys[i];
        if (typeof obj[key] !== 'undefined') {
            filtered[key] = obj[key];
        }
    }
    return filtered;
}
export function convertToUnit(str, unit = 'px') {
    if (str == null || str === '') {
        return undefined;
    }
    else if (isNaN(+str)) {
        return String(str);
    }
    else {
        return `${Number(str)}${unit}`;
    }
}
export function kebabCase(str) {
    return (str || '').replace(/([a-z])([A-Z])/g, '$1-$2').toLowerCase();
}
export function isObject(obj) {
    return obj !== null && typeof obj === 'object';
}
// KeyboardEvent.keyCode aliases
export const keyCodes = Object.freeze({
    enter: 13,
    tab: 9,
    delete: 46,
    esc: 27,
    space: 32,
    up: 38,
    down: 40,
    left: 37,
    right: 39,
    end: 35,
    home: 36,
    del: 46,
    backspace: 8,
    insert: 45,
    pageup: 33,
    pagedown: 34,
});
// This remaps internal names like '$cancel' or '$vuetify.icons.cancel'
// to the current name or component for that icon.
export function remapInternalIcon(vm, iconName) {
    if (!iconName.startsWith('$')) {
        return iconName;
    }
    // Get the target icon name
    const iconPath = `$vuetify.icons.values.${iconName.split('$').pop().split('.').pop()}`;
    // Now look up icon indirection name,
    // e.g. '$vuetify.icons.values.cancel'
    return getObjectValueByPath(vm, iconPath, iconName);
}
export function keys(o) {
    return Object.keys(o);
}
/**
 * Camelize a hyphen-delimited string.
 */
const camelizeRE = /-(\w)/g;
export const camelize = (str) => {
    return str.replace(camelizeRE, (_, c) => c ? c.toUpperCase() : '');
};
/**
 * Returns the set difference of B and A, i.e. the set of elements in B but not in A
 */
export function arrayDiff(a, b) {
    const diff = [];
    for (let i = 0; i < b.length; i++) {
        if (a.indexOf(b[i]) < 0)
            diff.push(b[i]);
    }
    return diff;
}
/**
 * Makes the first character of a string uppercase
 */
export function upperFirst(str) {
    return str.charAt(0).toUpperCase() + str.slice(1);
}
export function groupItems(items, groupBy, groupDesc) {
    const key = groupBy[0];
    const groups = [];
    let current = null;
    for (var i = 0; i < items.length; i++) {
        const item = items[i];
        const val = getObjectValueByPath(item, key);
        if (current !== val) {
            current = val;
            groups.push({
                name: val,
                items: [],
            });
        }
        groups[groups.length - 1].items.push(item);
    }
    return groups;
}
export function wrapInArray(v) { return v != null ? Array.isArray(v) ? v : [v] : []; }
export function sortItems(items, sortBy, sortDesc, locale, customSorters) {
    if (sortBy === null || !sortBy.length)
        return items;
    const stringCollator = new Intl.Collator(locale, { sensitivity: 'accent', usage: 'sort' });
    return items.sort((a, b) => {
        for (let i = 0; i < sortBy.length; i++) {
            const sortKey = sortBy[i];
            let sortA = getObjectValueByPath(a, sortKey);
            let sortB = getObjectValueByPath(b, sortKey);
            if (sortDesc[i]) {
                [sortA, sortB] = [sortB, sortA];
            }
            if (customSorters && customSorters[sortKey]) {
                const customResult = customSorters[sortKey](sortA, sortB);
                if (!customResult)
                    continue;
                return customResult;
            }
            // Check if both cannot be evaluated
            if (sortA === null && sortB === null) {
                continue;
            }
            [sortA, sortB] = [sortA, sortB].map(s => (s || '').toString().toLocaleLowerCase());
            if (sortA !== sortB) {
                if (!isNaN(sortA) && !isNaN(sortB))
                    return Number(sortA) - Number(sortB);
                return stringCollator.compare(sortA, sortB);
            }
        }
        return 0;
    });
}
export function defaultFilter(value, search, item) {
    return value != null &&
        search != null &&
        typeof value !== 'boolean' &&
        value.toString().toLocaleLowerCase().indexOf(search.toLocaleLowerCase()) !== -1;
}
export function searchItems(items, search) {
    if (!search)
        return items;
    search = search.toString().toLowerCase();
    if (search.trim() === '')
        return items;
    return items.filter(item => Object.keys(item).some(key => defaultFilter(getObjectValueByPath(item, key), search, item)));
}
/**
 * Returns:
 *  - 'normal' for old style slots - `<template slot="default">`
 *  - 'scoped' for old style scoped slots (`<template slot="default" slot-scope="data">`) or bound v-slot (`#default="data"`)
 *  - 'v-slot' for unbound v-slot (`#default`) - only if the third param is true, otherwise counts as scoped
 */
export function getSlotType(vm, name, split) {
    if (vm.$slots[name] && vm.$scopedSlots[name] && vm.$scopedSlots[name].name) {
        return split ? 'v-slot' : 'scoped';
    }
    if (vm.$slots[name])
        return 'normal';
    if (vm.$scopedSlots[name])
        return 'scoped';
}
export function debounce(fn, delay) {
    let timeoutId = 0;
    return (...args) => {
        clearTimeout(timeoutId);
        timeoutId = setTimeout(() => fn(...args), delay);
    };
}
export function throttle(fn, limit) {
    let throttling = false;
    return (...args) => {
        if (!throttling) {
            throttling = true;
            setTimeout(() => throttling = false, limit);
            return fn(...args);
        }
    };
}
export function getPrefixedScopedSlots(prefix, scopedSlots) {
    return Object.keys(scopedSlots).filter(k => k.startsWith(prefix)).reduce((obj, k) => {
        obj[k.replace(prefix, '')] = scopedSlots[k];
        return obj;
    }, {});
}
export function getSlot(vm, name = 'default', data, optional = false) {
    if (vm.$scopedSlots[name]) {
        return vm.$scopedSlots[name](data instanceof Function ? data() : data);
    }
    else if (vm.$slots[name] && (!data || optional)) {
        return vm.$slots[name];
    }
    return undefined;
}
export function clamp(value, min = 0, max = 1) {
    return Math.max(min, Math.min(max, value));
}
export function padEnd(str, length, char = '0') {
    return str + char.repeat(Math.max(0, length - str.length));
}
export function chunk(str, size = 1) {
    const chunked = [];
    let index = 0;
    while (index < str.length) {
        chunked.push(str.substr(index, size));
        index += size;
    }
    return chunked;
}
export function humanReadableFileSize(bytes, binary = false) {
    const base = binary ? 1024 : 1000;
    if (bytes < base) {
        return `${bytes} B`;
    }
    const prefix = binary ? ['Ki', 'Mi', 'Gi'] : ['k', 'M', 'G'];
    let unit = -1;
    while (Math.abs(bytes) >= base && unit < prefix.length - 1) {
        bytes /= base;
        ++unit;
    }
    return `${bytes.toFixed(1)} ${prefix[unit]}B`;
}
export function camelizeObjectKeys(obj) {
    if (!obj)
        return {};
    return Object.keys(obj).reduce((o, key) => {
        o[camelize(key)] = obj[key];
        return o;
    }, {});
}
export function mergeDeep(source = {}, target = {}) {
    for (const key in target) {
        const sourceProperty = source[key];
        const targetProperty = target[key];
        // Only continue deep merging if
        // both properties are objects
        if (isObject(sourceProperty) &&
            isObject(targetProperty)) {
            source[key] = mergeDeep(sourceProperty, targetProperty);
            continue;
        }
        source[key] = targetProperty;
    }
    return source;
}
export function fillArray(length, obj) {
    return Array(length).fill(obj);
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaGVscGVycy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy91dGlsL2hlbHBlcnMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxHQUFHLE1BQU0sS0FBSyxDQUFBO0FBS3JCLE1BQU0sVUFBVSxzQkFBc0IsQ0FDcEMsQ0FBUyxFQUNULEVBQUUsR0FBRyxLQUFLLEVBQ1YsSUFBYTtJQUViLE9BQU8sR0FBRyxDQUFDLE1BQU0sQ0FBQztRQUNoQixJQUFJLEVBQUUsSUFBSSxJQUFJLENBQUMsQ0FBQyxPQUFPLENBQUMsS0FBSyxFQUFFLEdBQUcsQ0FBQztRQUVuQyxVQUFVLEVBQUUsSUFBSTtRQUVoQixNQUFNLENBQUUsQ0FBQyxFQUFFLEVBQUUsSUFBSSxFQUFFLFFBQVEsRUFBRTtZQUMzQixJQUFJLENBQUMsV0FBVyxHQUFHLENBQUMsR0FBRyxDQUFDLElBQUksSUFBSSxDQUFDLFdBQVcsSUFBSSxFQUFFLEVBQUUsQ0FBQyxDQUFDLElBQUksRUFBRSxDQUFBO1lBRTVELE9BQU8sQ0FBQyxDQUFDLEVBQUUsRUFBRSxJQUFJLEVBQUUsUUFBUSxDQUFDLENBQUE7UUFDOUIsQ0FBQztLQUNGLENBQUMsQ0FBQTtBQUNKLENBQUM7QUFHRCxNQUFNLFVBQVUsZUFBZSxDQUFFLE9BQXNCLEVBQUUsUUFBUSxHQUFHLEVBQUU7SUFDcEUsT0FBTztRQUNMLEdBQUcsUUFBUTtRQUNYLEdBQUcsT0FBTyxDQUFDLFNBQVM7UUFDcEIsS0FBSyxFQUFFLE9BQU8sQ0FBQyxHQUFHO1FBQ2xCLEdBQUcsQ0FBQyxPQUFPLENBQUMsS0FBSyxJQUFJLEVBQUUsQ0FBQztLQUN6QixDQUFBO0FBQ0gsQ0FBQztBQUVELE1BQU0sVUFBVSxvQkFBb0IsQ0FDbEMsRUFBZSxFQUNmLFNBQWlCLEVBQ2pCLEVBQTBCLEVBQzFCLFVBQTZDLEtBQUs7SUFFbEQsSUFBSSxJQUFJLEdBQUcsQ0FBQyxLQUFZLEVBQUUsRUFBRTtRQUMxQixFQUFFLENBQUMsS0FB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QUFHLENBQUMsR0FBRyxTQUFTLENBQUMsY0FBYyxFQUFFLGNBQWMsQ0FBQyxDQUFBO1lBRXZELFNBQVE7U0FDVDtRQUVELE1BQU0sQ0FBQyxHQUFHLENBQUMsR0FBRyxjQUFjLENBQUE7S0FDN0I7SUFFRCxPQUFPLE1BQU0sQ0FBQTtBQUNmLENBQUM7QUFFRCxNQUFNLFVBQVUsU0FBUyxDQUFLLE1BQWMsRUFBRSxHQUFNO0lBQ2xELE9BQU8sS0FBSyxDQUFDLE1BQU0sQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQTtBQUNoQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFZ1ZSBmcm9tICd2dWUnXG5pbXBvcnQgeyBWTm9kZSwgVk5vZGVEaXJlY3RpdmUgfSBmcm9tICd2dWUvdHlwZXMnXG5pbXBvcnQgeyBWdWV0aWZ5SWNvbiB9IGZyb20gJ3Z1ZXRpZnkvdHlwZXMvc2VydmljZXMvaWNvbnMnXG5pbXBvcnQgeyBEYXRhVGFibGVDb21wYXJlRnVuY3Rpb24sIFNlbGVjdEl0ZW1LZXksIEl0ZW1Hcm91cCB9IGZyb20gJ3Z1ZXRpZnkvdHlwZXMnXG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVTaW1wbGVGdW5jdGlvbmFsIChcbiAgYzogc3RyaW5nLFxuICBlbCA9ICdkaXYnLFxuICBuYW1lPzogc3RyaW5nXG4pIHtcbiAgcmV0dXJuIFZ1ZS5leHRlbmQoe1xuICAgIG5hbWU6IG5hbWUgfHwgYy5yZXBsYWNlKC9fXy9nLCAnLScpLFxuXG4gICAgZnVuY3Rpb25hbDogdHJ1ZSxcblxuICAgIHJlbmRlciAoaCwgeyBkYXRhLCBjaGlsZHJlbiB9KTogVk5vZGUge1xuICAgICAgZGF0YS5zdGF0aWNDbGFzcyA9IChgJHtjfSAke2RhdGEuc3RhdGljQ2xhc3MgfHwgJyd9YCkudHJpbSgpXG5cbiAgICAgIHJldHVybiBoKGVsLCBkYXRhLCBjaGlsZHJlbilcbiAgICB9LFxuICB9KVxufVxuXG5leHBvcnQgdHlwZSBCaW5kaW5nQ29uZmlnID0gUGljazxWTm9kZURpcmVjdGl2ZSwgJ2FyZycgfCAnbW9kaWZpZXJzJyB8ICd2YWx1ZSc+XG5leHBvcnQgZnVuY3Rpb24gZGlyZWN0aXZlQ29uZmlnIChiaW5kaW5nOiBCaW5kaW5nQ29uZmlnLCBkZWZhdWx0cyA9IHt9KTogVk5vZGVEaXJlY3RpdmUge1xuICByZXR1cm4ge1xuICAgIC4uLmRlZmF1bHRzLFxuICAgIC4uLmJpbmRpbmcubW9kaWZpZXJzLFxuICAgIHZhbHVlOiBiaW5kaW5nLmFyZyxcbiAgICAuLi4oYmluZGluZy52YWx1ZSB8fCB7fSksXG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGFkZE9uY2VFdmVudExpc3RlbmVyIChcbiAgZWw6IEV2ZW50VGFyZ2V0LFxuICBldmVudE5hbWU6IHN0cmluZyxcbiAgY2I6IChldmVudDogRXZlbnQpID0+IHZvaWQsXG4gIG9wdGlvbnM6IGJvb2xlYW4gfCBBZGRFdmVudExpc3RlbmVyT3B0aW9ucyA9IGZhbHNlXG4pOiB2b2lkIHtcbiAgdmFyIG9uY2UgPSAoZXZlbnQ6IEV2ZW50KSA9PiB7XG4gICAgY2IoZXZlbnQpXG4gICAgZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcihldmVudE5hbWUsIG9uY2UsIG9wdGlvbnMpXG4gIH1cblxuICBlbC5hZGRFdmVudExpc3RlbmVyKGV2ZW50TmFtZSwgb25jZSwgb3B0aW9ucylcbn1cblxubGV0IHBhc3NpdmVTdXBwb3J0ZWQgPSBmYWxzZVxudHJ5IHtcbiAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgY29uc3QgdGVzdExpc3RlbmVyT3B0cyA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh7fSwgJ3Bhc3NpdmUnLCB7XG4gICAgICBnZXQ6ICgpID0+IHtcbiAgICAgICAgcGFzc2l2ZVN1cHBvcnRlZCA9IHRydWVcbiAgICAgIH0sXG4gICAgfSlcblxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCd0ZXN0TGlzdGVuZXInLCB0ZXN0TGlzdGVuZXJPcHRzLCB0ZXN0TGlzdGVuZXJPcHRzKVxuICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCd0ZXN0TGlzdGVuZXInLCB0ZXN0TGlzdGVuZXJPcHRzLCB0ZXN0TGlzdGVuZXJPcHRzKVxuICB9XG59IGNhdGNoIChlKSB7IGNvbnNvbGUud2FybihlKSB9XG5leHBvcnQgeyBwYXNzaXZlU3VwcG9ydGVkIH1cblxuZXhwb3J0IGZ1bmN0aW9uIGFkZFBhc3NpdmVFdmVudExpc3RlbmVyIChcbiAgZWw6IEV2ZW50VGFyZ2V0LFxuICBldmVudDogc3RyaW5nLFxuICBjYjogRXZlbnRIYW5kbGVyTm9uTnVsbCB8ICgoKSA9PiB2b2lkKSxcbiAgb3B0aW9uczoge31cbik6IHZvaWQge1xuICBlbC5hZGRFdmVudExpc3RlbmVyKGV2ZW50LCBjYiwgcGFzc2l2ZVN1cHBvcnRlZCA/IG9wdGlvbnMgOiBmYWxzZSlcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldE5lc3RlZFZhbHVlIChvYmo6IGFueSwgcGF0aDogKHN0cmluZyB8IG51bWJlcilbXSwgZmFsbGJhY2s/OiBhbnkpOiBhbnkge1xuICBjb25zdCBsYXN0ID0gcGF0aC5sZW5ndGggLSAxXG5cbiAgaWYgKGxhc3QgPCAwKSByZXR1cm4gb2JqID09PSB1bmRlZmluZWQgPyBmYWxsYmFjayA6IG9ialxuXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgbGFzdDsgaSsrKSB7XG4gICAgaWYgKG9iaiA9PSBudWxsKSB7XG4gICAgICByZXR1cm4gZmFsbGJhY2tcbiAgICB9XG4gICAgb2JqID0gb2JqW3BhdGhbaV1dXG4gIH1cblxuICBpZiAob2JqID09IG51bGwpIHJldHVybiBmYWxsYmFja1xuXG4gIHJldHVybiBvYmpbcGF0aFtsYXN0XV0gPT09IHVuZGVmaW5lZCA/IGZhbGxiYWNrIDogb2JqW3BhdGhbbGFzdF1dXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBkZWVwRXF1YWwgKGE6IGFueSwgYjogYW55KTogYm9vbGVhbiB7XG4gIGlmIChhID09PSBiKSByZXR1cm4gdHJ1ZVxuXG4gIGlmIChhIGluc3RhbmNlb2YgRGF0ZSAmJiBiIGluc3RhbmNlb2YgRGF0ZSkge1xuICAgIC8vIElmIHRoZSB2YWx1ZXMgYXJlIERhdGUsIHRoZXkgd2VyZSBjb252ZXJ0IHRvIHRpbWVzdGFtcCB3aXRoIGdldFRpbWUgYW5kIGNvbXBhcmUgaXRcbiAgICBpZiAoYS5nZXRUaW1lKCkgIT09IGIuZ2V0VGltZSgpKSByZXR1cm4gZmFsc2VcbiAgfVxuXG4gIGlmIChhICE9PSBPYmplY3QoYSkgfHwgYiAhPT0gT2JqZWN0KGIpKSB7XG4gICAgLy8gSWYgdGhlIHZhbHVlcyBhcmVuJ3Qgb2JqZWN0cywgdGhleSB3ZXJlIGFscmVhZHkgY2hlY2tlZCBmb3IgZXF1YWxpdHlcbiAgICByZXR1cm4gZmFsc2VcbiAgfVxuXG4gIGNvbnN0IHByb3BzID0gT2JqZWN0LmtleXMoYSlcblxuICBpZiAocHJvcHMubGVuZ3RoICE9PSBPYmplY3Qua2V5cyhiKS5sZW5ndGgpIHtcbiAgICAvLyBEaWZmZXJlbnQgbnVtYmVyIG9mIHByb3BzLCBkb24ndCBib3RoZXIgdG8gY2hlY2tcbiAgICByZXR1cm4gZmFsc2VcbiAgfVxuXG4gIHJldHVybiBwcm9wcy5ldmVyeShwID0+IGRlZXBFcXVhbChhW3BdLCBiW3BdKSlcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldE9iamVjdFZhbHVlQnlQYXRoIChvYmo6IGFueSwgcGF0aDogc3RyaW5nLCBmYWxsYmFjaz86IGFueSk6IGFueSB7XG4gIC8vIGNyZWRpdDogaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy82NDkxNDYzL2FjY2Vzc2luZy1uZXN0ZWQtamF2YXNjcmlwdC1vYmplY3RzLXdpdGgtc3RyaW5nLWtleSNjb21tZW50NTUyNzg0MTNfNjQ5MTYyMVxuICBpZiAob2JqID09IG51bGwgfHwgIXBhdGggfHwgdHlwZW9mIHBhdGggIT09ICdzdHJpbmcnKSByZXR1cm4gZmFsbGJhY2tcbiAgaWYgKG9ialtwYXRoXSAhPT0gdW5kZWZpbmVkKSByZXR1cm4gb2JqW3BhdGhdXG4gIHBhdGggPSBwYXRoLnJlcGxhY2UoL1xcWyhcXHcrKVxcXS9nLCAnLiQxJykgLy8gY29udmVydCBpbmRleGVzIHRvIHByb3BlcnRpZXNcbiAgcGF0aCA9IHBhdGgucmVwbGFjZSgvXlxcLi8sICcnKSAvLyBzdHJpcCBhIGxlYWRpbmcgZG90XG4gIHJldHVybiBnZXROZXN0ZWRWYWx1ZShvYmosIHBhdGguc3BsaXQoJy4nKSwgZmFsbGJhY2spXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRQcm9wZXJ0eUZyb21JdGVtIChcbiAgaXRlbTogb2JqZWN0LFxuICBwcm9wZXJ0eTogU2VsZWN0SXRlbUtleSxcbiAgZmFsbGJhY2s/OiBhbnlcbik6IGFueSB7XG4gIGlmIChwcm9wZXJ0eSA9PSBudWxsKSByZXR1cm4gaXRlbSA9PT0gdW5kZWZpbmVkID8gZmFsbGJhY2sgOiBpdGVtXG5cbiAgaWYgKGl0ZW0gIT09IE9iamVjdChpdGVtKSkgcmV0dXJuIGZhbGxiYWNrID09PSB1bmRlZmluZWQgPyBpdGVtIDogZmFsbGJhY2tcblxuICBpZiAodHlwZW9mIHByb3BlcnR5ID09PSAnc3RyaW5nJykgcmV0dXJuIGdldE9iamVjdFZhbHVlQnlQYXRoKGl0ZW0sIHByb3BlcnR5LCBmYWxsYmFjaylcblxuICBpZiAoQXJyYXkuaXNBcnJheShwcm9wZXJ0eSkpIHJldHVybiBnZXROZXN0ZWRWYWx1ZShpdGVtLCBwcm9wZXJ0eSwgZmFsbGJhY2spXG5cbiAgaWYgKHR5cGVvZiBwcm9wZXJ0eSAhPT0gJ2Z1bmN0aW9uJykgcmV0dXJuIGZhbGxiYWNrXG5cbiAgY29uc3QgdmFsdWUgPSBwcm9wZXJ0eShpdGVtLCBmYWxsYmFjaylcblxuICByZXR1cm4gdHlwZW9mIHZhbHVlID09PSAndW5kZWZpbmVkJyA/IGZhbGxiYWNrIDogdmFsdWVcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVJhbmdlIChsZW5ndGg6IG51bWJlcik6IG51bWJlcltdIHtcbiAgcmV0dXJuIEFycmF5LmZyb20oeyBsZW5ndGggfSwgKHYsIGspID0+IGspXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRaSW5kZXggKGVsPzogRWxlbWVudCB8IG51bGwpOiBudW1iZXIge1xuICBpZiAoIWVsIHx8IGVsLm5vZGVUeXBlICE9PSBOb2RlLkVMRU1FTlRfTk9ERSkgcmV0dXJuIDBcblxuICBjb25zdCBpbmRleCA9ICt3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShlbCkuZ2V0UHJvcGVydHlWYWx1ZSgnei1pbmRleCcpXG5cbiAgaWYgKCFpbmRleCkgcmV0dXJuIGdldFpJbmRleChlbC5wYXJlbnROb2RlIGFzIEVsZW1lbnQpXG4gIHJldHVybiBpbmRleFxufVxuXG5jb25zdCB0YWdzVG9SZXBsYWNlID0ge1xuICAnJic6ICcmYW1wOycsXG4gICc8JzogJyZsdDsnLFxuICAnPic6ICcmZ3Q7Jyxcbn0gYXMgYW55XG5cbmV4cG9ydCBmdW5jdGlvbiBlc2NhcGVIVE1MIChzdHI6IHN0cmluZyk6IHN0cmluZyB7XG4gIHJldHVybiBzdHIucmVwbGFjZSgvWyY8Pl0vZywgdGFnID0+IHRhZ3NUb1JlcGxhY2VbdGFnXSB8fCB0YWcpXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBmaWx0ZXJPYmplY3RPbktleXM8VCwgSyBleHRlbmRzIGtleW9mIFQ+IChvYmo6IFQsIGtleXM6IEtbXSk6IHsgW04gaW4gS106IFRbTl0gfSB7XG4gIGNvbnN0IGZpbHRlcmVkID0ge30gYXMgeyBbTiBpbiBLXTogVFtOXSB9XG5cbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBrZXlzLmxlbmd0aDsgaSsrKSB7XG4gICAgY29uc3Qga2V5ID0ga2V5c1tpXVxuICAgIGlmICh0eXBlb2Ygb2JqW2tleV0gIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICBmaWx0ZXJlZFtrZXldID0gb2JqW2tleV1cbiAgICB9XG4gIH1cblxuICByZXR1cm4gZmlsdGVyZWRcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNvbnZlcnRUb1VuaXQgKHN0cjogc3RyaW5nIHwgbnVtYmVyIHwgbnVsbCB8IHVuZGVmaW5lZCwgdW5pdCA9ICdweCcpOiBzdHJpbmcgfCB1bmRlZmluZWQge1xuICBpZiAoc3RyID09IG51bGwgfHwgc3RyID09PSAnJykge1xuICAgIHJldHVybiB1bmRlZmluZWRcbiAgfSBlbHNlIGlmIChpc05hTigrc3RyISkpIHtcbiAgICByZXR1cm4gU3RyaW5nKHN0cilcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gYCR7TnVtYmVyKHN0cil9JHt1bml0fWBcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24ga2ViYWJDYXNlIChzdHI6IHN0cmluZyk6IHN0cmluZyB7XG4gIHJldHVybiAoc3RyIHx8ICcnKS5yZXBsYWNlKC8oW2Etel0pKFtBLVpdKS9nLCAnJDEtJDInKS50b0xvd2VyQ2FzZSgpXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc09iamVjdCAob2JqOiBhbnkpOiBvYmogaXMgb2JqZWN0IHtcbiAgcmV0dXJuIG9iaiAhPT0gbnVsbCAmJiB0eXBlb2Ygb2JqID09PSAnb2JqZWN0J1xufVxuXG4vLyBLZXlib2FyZEV2ZW50LmtleUNvZGUgYWxpYXNlc1xuZXhwb3J0IGNvbnN0IGtleUNvZGVzID0gT2JqZWN0LmZyZWV6ZSh7XG4gIGVudGVyOiAxMyxcbiAgdGFiOiA5LFxuICBkZWxldGU6IDQ2LFxuICBlc2M6IDI3LFxuICBzcGFjZTogMzIsXG4gIHVwOiAzOCxcbiAgZG93bjogNDAsXG4gIGxlZnQ6IDM3LFxuICByaWdodDogMzksXG4gIGVuZDogMzUsXG4gIGhvbWU6IDM2LFxuICBkZWw6IDQ2LFxuICBiYWNrc3BhY2U6IDgsXG4gIGluc2VydDogNDUsXG4gIHBhZ2V1cDogMzMsXG4gIHBhZ2Vkb3duOiAzNCxcbn0pXG5cbi8vIFRoaXMgcmVtYXBzIGludGVybmFsIG5hbWVzIGxpa2UgJyRjYW5jZWwnIG9yICckdnVldGlmeS5pY29ucy5jYW5jZWwnXG4vLyB0byB0aGUgY3VycmVudCBuYW1lIG9yIGNvbXBvbmVudCBmb3IgdGhhdCBpY29uLlxuZXhwb3J0IGZ1bmN0aW9uIHJlbWFwSW50ZXJuYWxJY29uICh2bTogVnVlLCBpY29uTmFtZTogc3RyaW5nKTogVnVldGlmeUljb24ge1xuICBpZiAoIWljb25OYW1lLnN0YXJ0c1dpdGgoJyQnKSkge1xuICAgIHJldHVybiBpY29uTmFtZVxuICB9XG5cbiAgLy8gR2V0IHRoZSB0YXJnZXQgaWNvbiBuYW1lXG4gIGNvbnN0IGljb25QYXRoID0gYCR2dWV0aWZ5Lmljb25zLnZhbHVlcy4ke2ljb25OYW1lLnNwbGl0KCckJykucG9wKCkhLnNwbGl0KCcuJykucG9wKCl9YFxuXG4gIC8vIE5vdyBsb29rIHVwIGljb24gaW5kaXJlY3Rpb24gbmFtZSxcbiAgLy8gZS5nLiAnJHZ1ZXRpZnkuaWNvbnMudmFsdWVzLmNhbmNlbCdcbiAgcmV0dXJuIGdldE9iamVjdFZhbHVlQnlQYXRoKHZtLCBpY29uUGF0aCwgaWNvbk5hbWUpXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBrZXlzPE8+IChvOiBPKSB7XG4gIHJldHVybiBPYmplY3Qua2V5cyhvKSBhcyAoa2V5b2YgTylbXVxufVxuXG4vKipcbiAqIENhbWVsaXplIGEgaHlwaGVuLWRlbGltaXRlZCBzdHJpbmcuXG4gKi9cbmNvbnN0IGNhbWVsaXplUkUgPSAvLShcXHcpL2dcbmV4cG9ydCBjb25zdCBjYW1lbGl6ZSA9IChzdHI6IHN0cmluZyk6IHN0cmluZyA9PiB7XG4gIHJldHVybiBzdHIucmVwbGFjZShjYW1lbGl6ZVJFLCAoXywgYykgPT4gYyA/IGMudG9VcHBlckNhc2UoKSA6ICcnKVxufVxuXG4vKipcbiAqIFJldHVybnMgdGhlIHNldCBkaWZmZXJlbmNlIG9mIEIgYW5kIEEsIGkuZS4gdGhlIHNldCBvZiBlbGVtZW50cyBpbiBCIGJ1dCBub3QgaW4gQVxuICovXG5leHBvcnQgZnVuY3Rpb24gYXJyYXlEaWZmIChhOiBhbnlbXSwgYjogYW55W10pOiBhbnlbXSB7XG4gIGNvbnN0IGRpZmY6IGFueVtdID0gW11cbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBiLmxlbmd0aDsgaSsrKSB7XG4gICAgaWYgKGEuaW5kZXhPZihiW2ldKSA8IDApIGRpZmYucHVzaChiW2ldKVxuICB9XG4gIHJldHVybiBkaWZmXG59XG5cbi8qKlxuICogTWFrZXMgdGhlIGZpcnN0IGNoYXJhY3RlciBvZiBhIHN0cmluZyB1cHBlcmNhc2VcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHVwcGVyRmlyc3QgKHN0cjogc3RyaW5nKTogc3RyaW5nIHtcbiAgcmV0dXJuIHN0ci5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIHN0ci5zbGljZSgxKVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZ3JvdXBJdGVtczxUIGV4dGVuZHMgYW55ID0gYW55PiAoXG4gIGl0ZW1zOiBUW10sXG4gIGdyb3VwQnk6IHN0cmluZ1tdLFxuICBncm91cERlc2M6IGJvb2xlYW5bXVxuKTogSXRlbUdyb3VwPFQ+W10ge1xuICBjb25zdCBrZXkgPSBncm91cEJ5WzBdXG4gIGNvbnN0IGdyb3VwczogSXRlbUdyb3VwPFQ+W10gPSBbXVxuICBsZXQgY3VycmVudCA9IG51bGxcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBpdGVtcy5sZW5ndGg7IGkrKykge1xuICAgIGNvbnN0IGl0ZW0gPSBpdGVtc1tpXVxuICAgIGNvbnN0IHZhbCA9IGdldE9iamVjdFZhbHVlQnlQYXRoKGl0ZW0sIGtleSlcbiAgICBpZiAoY3VycmVudCAhPT0gdmFsKSB7XG4gICAgICBjdXJyZW50ID0gdmFsXG4gICAgICBncm91cHMucHVzaCh7XG4gICAgICAgIG5hbWU6IHZhbCxcbiAgICAgICAgaXRlbXM6IFtdLFxuICAgICAgfSlcbiAgICB9XG4gICAgZ3JvdXBzW2dyb3Vwcy5sZW5ndGggLSAxXS5pdGVtcy5wdXNoKGl0ZW0pXG4gIH1cbiAgcmV0dXJuIGdyb3Vwc1xufVxuXG5leHBvcnQgZnVuY3Rpb24gd3JhcEluQXJyYXk8VD4gKHY6IFQgfCBUW10gfCBudWxsIHwgdW5kZWZpbmVkKTogVFtdIHsgcmV0dXJuIHYgIT0gbnVsbCA/IEFycmF5LmlzQXJyYXkodikgPyB2IDogW3ZdIDogW10gfVxuXG5leHBvcnQgZnVuY3Rpb24gc29ydEl0ZW1zPFQgZXh0ZW5kcyBhbnkgPSBhbnk+IChcbiAgaXRlbXM6IFRbXSxcbiAgc29ydEJ5OiBzdHJpbmdbXSxcbiAgc29ydERlc2M6IGJvb2xlYW5bXSxcbiAgbG9jYWxlOiBzdHJpbmcsXG4gIGN1c3RvbVNvcnRlcnM/OiBSZWNvcmQ8c3RyaW5nLCBEYXRhVGFibGVDb21wYXJlRnVuY3Rpb248VD4+XG4pOiBUW10ge1xuICBpZiAoc29ydEJ5ID09PSBudWxsIHx8ICFzb3J0QnkubGVuZ3RoKSByZXR1cm4gaXRlbXNcbiAgY29uc3Qgc3RyaW5nQ29sbGF0b3IgPSBuZXcgSW50bC5Db2xsYXRvcihsb2NhbGUsIHsgc2Vuc2l0aXZpdHk6ICdhY2NlbnQnLCB1c2FnZTogJ3NvcnQnIH0pXG5cbiAgcmV0dXJuIGl0ZW1zLnNvcnQoKGEsIGIpID0+IHtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNvcnRCeS5sZW5ndGg7IGkrKykge1xuICAgICAgY29uc3Qgc29ydEtleSA9IHNvcnRCeVtpXVxuXG4gICAgICBsZXQgc29ydEEgPSBnZXRPYmplY3RWYWx1ZUJ5UGF0aChhLCBzb3J0S2V5KVxuICAgICAgbGV0IHNvcnRCID0gZ2V0T2JqZWN0VmFsdWVCeVBhdGgoYiwgc29ydEtleSlcblxuICAgICAgaWYgKHNvcnREZXNjW2ldKSB7XG4gICAgICAgIFtzb3J0QSwgc29ydEJdID0gW3NvcnRCLCBzb3J0QV1cbiAgICAgIH1cblxuICAgICAgaWYgKGN1c3RvbVNvcnRlcnMgJiYgY3VzdG9tU29ydGVyc1tzb3J0S2V5XSkge1xuICAgICAgICBjb25zdCBjdXN0b21SZXN1bHQgPSBjdXN0b21Tb3J0ZXJzW3NvcnRLZXldKHNvcnRBLCBzb3J0QilcblxuICAgICAgICBpZiAoIWN1c3RvbVJlc3VsdCkgY29udGludWVcblxuICAgICAgICByZXR1cm4gY3VzdG9tUmVzdWx0XG4gICAgICB9XG5cbiAgICAgIC8vIENoZWNrIGlmIGJvdGggY2Fubm90IGJlIGV2YWx1YXRlZFxuICAgICAgaWYgKHNvcnRBID09PSBudWxsICYmIHNvcnRCID09PSBudWxsKSB7XG4gICAgICAgIGNvbnRpbnVlXG4gICAgICB9XG5cbiAgICAgIFtzb3J0QSwgc29ydEJdID0gW3NvcnRBLCBzb3J0Ql0ubWFwKHMgPT4gKHMgfHwgJycpLnRvU3RyaW5nKCkudG9Mb2NhbGVMb3dlckNhc2UoKSlcblxuICAgICAgaWYgKHNvcnRBICE9PSBzb3J0Qikge1xuICAgICAgICBpZiAoIWlzTmFOKHNvcnRBKSAmJiAhaXNOYU4oc29ydEIpKSByZXR1cm4gTnVtYmVyKHNvcnRBKSAtIE51bWJlcihzb3J0QilcbiAgICAgICAgcmV0dXJuIHN0cmluZ0NvbGxhdG9yLmNvbXBhcmUoc29ydEEsIHNvcnRCKVxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiAwXG4gIH0pXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBkZWZhdWx0RmlsdGVyICh2YWx1ZTogYW55LCBzZWFyY2g6IHN0cmluZyB8IG51bGwsIGl0ZW06IGFueSkge1xuICByZXR1cm4gdmFsdWUgIT0gbnVsbCAmJlxuICAgIHNlYXJjaCAhPSBudWxsICYmXG4gICAgdHlwZW9mIHZhbHVlICE9PSAnYm9vbGVhbicgJiZcbiAgICB2YWx1ZS50b1N0cmluZygpLnRvTG9jYWxlTG93ZXJDYXNlKCkuaW5kZXhPZihzZWFyY2gudG9Mb2NhbGVMb3dlckNhc2UoKSkgIT09IC0xXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzZWFyY2hJdGVtczxUIGV4dGVuZHMgYW55ID0gYW55PiAoaXRlbXM6IFRbXSwgc2VhcmNoOiBzdHJpbmcpOiBUW10ge1xuICBpZiAoIXNlYXJjaCkgcmV0dXJuIGl0ZW1zXG4gIHNlYXJjaCA9IHNlYXJjaC50b1N0cmluZygpLnRvTG93ZXJDYXNlKClcbiAgaWYgKHNlYXJjaC50cmltKCkgPT09ICcnKSByZXR1cm4gaXRlbXNcblxuICByZXR1cm4gaXRlbXMuZmlsdGVyKGl0ZW0gPT4gT2JqZWN0LmtleXMoaXRlbSkuc29tZShrZXkgPT4gZGVmYXVsdEZpbHRlcihnZXRPYmplY3RWYWx1ZUJ5UGF0aChpdGVtLCBrZXkpLCBzZWFyY2gsIGl0ZW0pKSlcbn1cblxuLyoqXG4gKiBSZXR1cm5zOlxuICogIC0gJ25vcm1hbCcgZm9yIG9sZCBzdHlsZSBzbG90cyAtIGA8dGVtcGxhdGUgc2xvdD1cImRlZmF1bHRcIj5gXG4gKiAgLSAnc2NvcGVkJyBmb3Igb2xkIHN0eWxlIHNjb3BlZCBzbG90cyAoYDx0ZW1wbGF0ZSBzbG90PVwiZGVmYXVsdFwiIHNsb3Qtc2NvcGU9XCJkYXRhXCI+YCkgb3IgYm91bmQgdi1zbG90IChgI2RlZmF1bHQ9XCJkYXRhXCJgKVxuICogIC0gJ3Ytc2xvdCcgZm9yIHVuYm91bmQgdi1zbG90IChgI2RlZmF1bHRgKSAtIG9ubHkgaWYgdGhlIHRoaXJkIHBhcmFtIGlzIHRydWUsIG90aGVyd2lzZSBjb3VudHMgYXMgc2NvcGVkXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRTbG90VHlwZTxUIGV4dGVuZHMgYm9vbGVhbiA9IGZhbHNlPiAodm06IFZ1ZSwgbmFtZTogc3RyaW5nLCBzcGxpdD86IFQpOiAoVCBleHRlbmRzIHRydWUgPyAndi1zbG90JyA6IG5ldmVyKSB8ICdub3JtYWwnIHwgJ3Njb3BlZCcgfCB2b2lkIHtcbiAgaWYgKHZtLiRzbG90c1tuYW1lXSAmJiB2bS4kc2NvcGVkU2xvdHNbbmFtZV0gJiYgKHZtLiRzY29wZWRTbG90c1tuYW1lXSBhcyBhbnkpLm5hbWUpIHtcbiAgICByZXR1cm4gc3BsaXQgPyAndi1zbG90JyBhcyBhbnkgOiAnc2NvcGVkJ1xuICB9XG4gIGlmICh2bS4kc2xvdHNbbmFtZV0pIHJldHVybiAnbm9ybWFsJ1xuICBpZiAodm0uJHNjb3BlZFNsb3RzW25hbWVdKSByZXR1cm4gJ3Njb3BlZCdcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGRlYm91bmNlIChmbjogRnVuY3Rpb24sIGRlbGF5OiBudW1iZXIpIHtcbiAgbGV0IHRpbWVvdXRJZCA9IDAgYXMgYW55XG4gIHJldHVybiAoLi4uYXJnczogYW55W10pID0+IHtcbiAgICBjbGVhclRpbWVvdXQodGltZW91dElkKVxuICAgIHRpbWVvdXRJZCA9IHNldFRpbWVvdXQoKCkgPT4gZm4oLi4uYXJncyksIGRlbGF5KVxuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB0aHJvdHRsZTxUIGV4dGVuZHMgKC4uLmFyZ3M6IGFueVtdKSA9PiBhbnk+IChmbjogVCwgbGltaXQ6IG51bWJlcikge1xuICBsZXQgdGhyb3R0bGluZyA9IGZhbHNlXG4gIHJldHVybiAoLi4uYXJnczogUGFyYW1ldGVyczxUPik6IHZvaWQgfCBSZXR1cm5UeXBlPFQ+ID0+IHtcbiAgICBpZiAoIXRocm90dGxpbmcpIHtcbiAgICAgIHRocm90dGxpbmcgPSB0cnVlXG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHRocm90dGxpbmcgPSBmYWxzZSwgbGltaXQpXG4gICAgICByZXR1cm4gZm4oLi4uYXJncylcbiAgICB9XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldFByZWZpeGVkU2NvcGVkU2xvdHMgKHByZWZpeDogc3RyaW5nLCBzY29wZWRTbG90czogYW55KSB7XG4gIHJldHVybiBPYmplY3Qua2V5cyhzY29wZWRTbG90cykuZmlsdGVyKGsgPT4gay5zdGFydHNXaXRoKHByZWZpeCkpLnJlZHVjZSgob2JqOiBhbnksIGs6IHN0cmluZykgPT4ge1xuICAgIG9ialtrLnJlcGxhY2UocHJlZml4LCAnJyldID0gc2NvcGVkU2xvdHNba11cbiAgICByZXR1cm4gb2JqXG4gIH0sIHt9KVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0U2xvdCAodm06IFZ1ZSwgbmFtZSA9ICdkZWZhdWx0JywgZGF0YT86IG9iamVjdCB8ICgoKSA9PiBvYmplY3QpLCBvcHRpb25hbCA9IGZhbHNlKSB7XG4gIGlmICh2bS4kc2NvcGVkU2xvdHNbbmFtZV0pIHtcbiAgICByZXR1cm4gdm0uJHNjb3BlZFNsb3RzW25hbWVdIShkYXRhIGluc3RhbmNlb2YgRnVuY3Rpb24gPyBkYXRhKCkgOiBkYXRhKVxuICB9IGVsc2UgaWYgKHZtLiRzbG90c1tuYW1lXSAmJiAoIWRhdGEgfHwgb3B0aW9uYWwpKSB7XG4gICAgcmV0dXJuIHZtLiRzbG90c1tuYW1lXVxuICB9XG4gIHJldHVybiB1bmRlZmluZWRcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNsYW1wICh2YWx1ZTogbnVtYmVyLCBtaW4gPSAwLCBtYXggPSAxKSB7XG4gIHJldHVybiBNYXRoLm1heChtaW4sIE1hdGgubWluKG1heCwgdmFsdWUpKVxufVxuXG5leHBvcnQgZnVuY3Rpb24gcGFkRW5kIChzdHI6IHN0cmluZywgbGVuZ3RoOiBudW1iZXIsIGNoYXIgPSAnMCcpIHtcbiAgcmV0dXJuIHN0ciArIGNoYXIucmVwZWF0KE1hdGgubWF4KDAsIGxlbmd0aCAtIHN0ci5sZW5ndGgpKVxufVxuXG5leHBvcnQgZnVuY3Rpb24gY2h1bmsgKHN0cjogc3RyaW5nLCBzaXplID0gMSkge1xuICBjb25zdCBjaHVua2VkOiBzdHJpbmdbXSA9IFtdXG4gIGxldCBpbmRleCA9IDBcbiAgd2hpbGUgKGluZGV4IDwgc3RyLmxlbmd0aCkge1xuICAgIGNodW5rZWQucHVzaChzdHIuc3Vic3RyKGluZGV4LCBzaXplKSlcbiAgICBpbmRleCArPSBzaXplXG4gIH1cbiAgcmV0dXJuIGNodW5rZWRcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGh1bWFuUmVhZGFibGVGaWxlU2l6ZSAoYnl0ZXM6IG51bWJlciwgYmluYXJ5ID0gZmFsc2UpOiBzdHJpbmcge1xuICBjb25zdCBiYXNlID0gYmluYXJ5ID8gMTAyNCA6IDEwMDBcbiAgaWYgKGJ5dGVzIDwgYmFzZSkge1xuICAgIHJldHVybiBgJHtieXRlc30gQmBcbiAgfVxuXG4gIGNvbnN0IHByZWZpeCA9IGJpbmFyeSA/IFsnS2knLCAnTWknLCAnR2knXSA6IFsnaycsICdNJywgJ0cnXVxuICBsZXQgdW5pdCA9IC0xXG4gIHdoaWxlIChNYXRoLmFicyhieXRlcykgPj0gYmFzZSAmJiB1bml0IDwgcHJlZml4Lmxlbmd0aCAtIDEpIHtcbiAgICBieXRlcyAvPSBiYXNlXG4gICAgKyt1bml0XG4gIH1cbiAgcmV0dXJuIGAke2J5dGVzLnRvRml4ZWQoMSl9ICR7cHJlZml4W3VuaXRdfUJgXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjYW1lbGl6ZU9iamVjdEtleXMgKG9iajogUmVjb3JkPHN0cmluZywgYW55PiB8IG51bGwgfCB1bmRlZmluZWQpIHtcbiAgaWYgKCFvYmopIHJldHVybiB7fVxuXG4gIHJldHVybiBPYmplY3Qua2V5cyhvYmopLnJlZHVjZSgobzogYW55LCBrZXk6IHN0cmluZykgPT4ge1xuICAgIG9bY2FtZWxpemUoa2V5KV0gPSBvYmpba2V5XVxuICAgIHJldHVybiBvXG4gIH0sIHt9KVxufVxuXG5leHBvcnQgZnVuY3Rpb24gbWVyZ2VEZWVwIChcbiAgc291cmNlOiBEaWN0aW9uYXJ5PGFueT4gPSB7fSxcbiAgdGFyZ2V0OiBEaWN0aW9uYXJ5PGFueT4gPSB7fVxuKSB7XG4gIGZvciAoY29uc3Qga2V5IGluIHRhcmdldCkge1xuICAgIGNvbnN0IHNvdXJjZVByb3BlcnR5ID0gc291cmNlW2tleV1cbiAgICBjb25zdCB0YXJnZXRQcm9wZXJ0eSA9IHRhcmdldFtrZXldXG5cbiAgICAvLyBPbmx5IGNvbnRpbnVlIGRlZXAgbWVyZ2luZyBpZlxuICAgIC8vIGJvdGggcHJvcGVydGllcyBhcmUgb2JqZWN0c1xuICAgIGlmIChcbiAgICAgIGlzT2JqZWN0KHNvdXJjZVByb3BlcnR5KSAmJlxuICAgICAgaXNPYmplY3QodGFyZ2V0UHJvcGVydHkpXG4gICAgKSB7XG4gICAgICBzb3VyY2Vba2V5XSA9IG1lcmdlRGVlcChzb3VyY2VQcm9wZXJ0eSwgdGFyZ2V0UHJvcGVydHkpXG5cbiAgICAgIGNvbnRpbnVlXG4gICAgfVxuXG4gICAgc291cmNlW2tleV0gPSB0YXJnZXRQcm9wZXJ0eVxuICB9XG5cbiAgcmV0dXJuIHNvdXJjZVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZmlsbEFycmF5PFQ+IChsZW5ndGg6IG51bWJlciwgb2JqOiBUKSB7XG4gIHJldHVybiBBcnJheShsZW5ndGgpLmZpbGwob2JqKVxufVxuIl19